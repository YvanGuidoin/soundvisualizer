!function(e){function t(t){for(var i,n,o=t[0],l=t[1],h=t[2],u=0,d=[];u<o.length;u++)n=o[u],s[n]&&d.push(s[n][0]),s[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(c&&c(t);d.length;)d.shift()();return r.push.apply(r,h||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],i=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(i=!1)}i&&(r.splice(t--,1),e=n(n.s=a[0]))}return e}var i={},s={1:0},r=[];function n(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=i,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var h=0;h<o.length;h++)t(o[h]);var c=l;r.push([6,0]),a()}({6:function(e,t,a){"use strict";a.r(t);var i=a(0),s=a.n(i),r=a(5);class n extends s.a.Component{constructor(e){super(e),this.state={circleRadius:n.getRadiusFromProps(e),maxBarSize:n.getMaxBarSize(e)},this.canvas=s.a.createRef(),this.spectrum=new Uint8Array(e.fftSize/2),this.audioCtx=new AudioContext,this.processSound=this.processSound.bind(this),this.draw=this.draw.bind(this)}componentDidMount(){const{fftSize:e}=this.props;this.analyser=this.audioCtx.createAnalyser(),this.analyser.fftSize=e,this.analyser.smoothingTimeConstant=.6,this.processSound(this.props.soundStream),requestAnimationFrame(this.draw)}static getDerivedStateFromProps(e){return{circleRadius:n.getRadiusFromProps(e),maxBarSize:n.getMaxBarSize(e)}}componentDidUpdate(e,t){this.analyser.fftSize=this.props.fftSize,this.spectrum=new Uint8Array(this.props.fftSize/2),this.processSound(this.props.soundStream)}componentWillUnmount(){this.analyser&&this.analyser.numberOfInputs>0&&this.analyser.disconnect(),this.audioCtx&&this.audioCtx.close(),this.analyser=null,this.audioCtx=null}static distributeAngles(e,t){return e/t*2*Math.PI+Math.PI/3}static getRadiusFromProps(e){return Math.min(e.width,e.height)*e.ratio/2}static getMaxBarSize(e){return Math.min(e.width,e.height)*(1-e.ratio)/2}processSound(e){const{width:t,height:a,fftSize:i}=this.props,{circleRadius:s}=this.state,r=i/2;this.particles=Array(r).fill({}).map((e,i)=>{const o=n.distributeAngles(i,r);return{x:t/2+Math.cos(o)*s,y:a/2+Math.sin(o)*s,angle:o}}),this.audioCtx.createMediaStreamSource(e).connect(this.analyser)}draw(){const{width:e,height:t,lineWidth:a,fftSize:i}=this.props,{maxBarSize:s,circleRadius:r}=this.state;if(this.analyser&&this.analyser.numberOfInputs>0){this.analyser.getByteFrequencyData(this.spectrum);const o=i/2,l=this.canvas.current.getContext("2d");l.clearRect(0,0,e,t),l.fillStyle="#ff7f27",l.strokeStyle="#ff7f27",l.lineWidth=a||1;let h,c,u,d=0;for(var n=0;n<o;n++){d+=this.spectrum[n],h=this.spectrum[n]/256*s;const a=this.particles[n];c=e/2+Math.cos(a.angle)*(h+r),u=t/2+Math.sin(a.angle)*(h+r),l.beginPath(),l.moveTo(a.x,a.y),l.lineTo(c,u),l.stroke(),l.closePath()}d/=o,d/=256,this.drawLogo(l,d)}requestAnimationFrame(this.draw)}drawLogo(e,t){const{width:a,height:i}=this.props,{circleRadius:s}=this.state,r=a/2,n=i/2,o=s/3;[e=>{e.moveTo(r-s/3,n+s/2),e.lineTo(r+s/3,n+s/2)},e=>{e.moveTo(r,n+s/2),e.lineTo(r,n+s/3)},e=>{e.arc(r,n,s/3,0,Math.PI)},e=>{e.arc(r,n,o,0,Math.PI),e.moveTo(r+o,n-o),e.lineTo(r+o,n),e.arc(r,n-o,o,0,Math.PI,!0),e.moveTo(r-o,n-o),e.lineTo(r-o,n)}].forEach(t=>{e.beginPath(),t(e),e.stroke(),e.closePath()});const l=s,h=Math.floor(l*t);if(!(h<1))if(h<o){const t=(o-h)/o,a=Math.asin(t),i=Math.cos(a);e.beginPath(),e.arc(r,n,o,a,Math.PI-a),e.lineTo(r+i*o,n+t*o),e.closePath(),e.fill()}else if(h<2*o){const t=h-o;e.beginPath(),e.arc(r,n,o,0,Math.PI),e.lineTo(r-o,n-t),e.lineTo(r+o,n-t),e.lineTo(r+o,n),e.closePath(),e.fill()}else{const t=(o-(h-2*o))/o,a=Math.asin(t),i=Math.cos(a);e.beginPath(),e.arc(r,n,o,0,Math.PI),e.lineTo(r-o,n-o),e.arc(r,n-o,o,Math.PI,Math.PI+a),e.lineTo(r+i*o,n-o-t*o),e.arc(r,n-o,o,2*Math.PI-a,2*Math.PI),e.lineTo(r+o,n),e.closePath(),e.fill()}}render(){return s.a.createElement("canvas",{width:this.props.width,height:this.props.height,ref:this.canvas})}}var o=n;const l={audio:!0},h={display:"grid",justifyItems:"center",gridGap:"1rem",padding:"1rem"},c={backgroundColor:"white"};var u=class extends s.a.Component{constructor(e){super(e),this.state={devices:null,selectedMic:null,displayTestAudio:!1,audioStreamForceUpdate:1,width:400,height:400,ratio:.5,fftSize:8,lineWidth:1.2},this.createDevices=this.createDevices.bind(this),this.changeTestAudioSource=this.changeTestAudioSource.bind(this)}componentWillMount(){this.createDevices()}componentWillUnmount(){this.testStreamAudio&&this.testStreamAudio.getTracks().forEach(e=>e.stop())}async createDevices(){if(navigator.mediaDevices.enumerateDevices){let e=null;try{e=await navigator.mediaDevices.getUserMedia(l);const t={audio:(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind)},a=e.getTracks().find(e=>"audio"===e.kind),i=t.audio.find(e=>e.label===a.label),s=i?i.deviceId:t.audio.length>0?t.audio[0].deviceId:null;this.setState({devices:t,selectedMic:s},()=>this.changeTestAudioSource())}catch(e){console.error(e)}finally{e&&e.getTracks().forEach(e=>e.stop())}}}async changeTestAudioSource(){const{selectedMic:e}=this.state,t=await navigator.mediaDevices.getUserMedia({video:!1,audio:{deviceId:e,sampleRate:{ideal:8e3}}});await function(e){return new Promise(t=>{setTimeout(()=>t(),e)})}(500),this.testStreamAudio&&this.testStreamAudio.getTracks().forEach(e=>e.stop()),this.testStreamAudio=t,this.setState({displayTestAudio:!0})}render(){const{devices:e,selectedMic:t,displayTestAudio:a,width:i,height:r,ratio:n,lineWidth:l}=this.state;return s.a.createElement("div",{style:h},s.a.createElement("label",null,"Microphone:",s.a.createElement("select",{value:t||"",onChange:e=>this.setState({selectedMic:e.target.value},()=>this.changeTestAudioSource())},e&&e.audio&&e.audio.map(e=>s.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label)))),s.a.createElement("label",null,"Width:",s.a.createElement("input",{type:"number",value:this.state.width,min:1,max:1e3,onChange:e=>this.setState({width:Number.parseInt(e.target.value)})})),s.a.createElement("label",null,"Height:",s.a.createElement("input",{type:"number",value:this.state.height,min:1,max:1e3,onChange:e=>this.setState({height:Number.parseInt(e.target.value)})})),s.a.createElement("label",null,"Ratio:",s.a.createElement("input",{type:"range",value:this.state.ratio,step:.01,min:0,max:1,onChange:e=>this.setState({ratio:Number.parseFloat(e.target.value)})})),s.a.createElement("label",null,"FFT Size:",s.a.createElement("input",{type:"range",value:this.state.fftSize,step:1,min:5,max:15,onChange:e=>this.setState({fftSize:Number.parseInt(e.target.value)})})),s.a.createElement("label",null,"Line Width:",s.a.createElement("input",{type:"range",value:this.state.lineWidth,step:.1,min:.1,max:10,onChange:e=>this.setState({lineWidth:Number.parseFloat(e.target.value)})})),s.a.createElement("div",{style:c},a&&s.a.createElement(o,{soundStream:this.testStreamAudio,fftSize:Math.pow(2,this.state.fftSize),forceUpdater:++this.state.audioStreamForceUpdate,width:i,height:r,ratio:n,lineWidth:l})))}};a.n(r).a.render(s.a.createElement("div",{style:{width:"100vw",height:"100vh"}},s.a.createElement(u,null)),document.getElementById("root"))}});