!function(e){function t(t){for(var a,r,o=t[0],l=t[1],c=t[2],u=0,d=[];u<o.length;u++)r=o[u],n[r]&&d.push(n[r][0]),n[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(h&&h(t);d.length;)d.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==n[l]&&(a=!1)}a&&(s.splice(t--,1),e=r(r.s=i[0]))}return e}var a={},n={1:0},s=[];function r(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=a,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var h=l;s.push([6,0]),i()}({6:function(e,t,i){"use strict";i.r(t);var a=i(0),n=i.n(a),s=i(5);class r extends n.a.Component{constructor(e){super(e),this.state={circleRadius:r.getRadiusFromProps(e),maxBarSize:r.getMaxBarSize(e)},this.canvas=n.a.createRef(),this.spectrum=new Uint8Array(e.fftSize/2),this.audioCtx=new AudioContext,this.processSound=this.processSound.bind(this),this.draw=this.draw.bind(this)}componentDidMount(){const e=this.props.fftSize;this.analyser=this.audioCtx.createAnalyser(),this.analyser.fftSize=e,this.analyser.smoothingTimeConstant=.6,this.processSound(this.props.soundStream),requestAnimationFrame(this.draw)}static getDerivedStateFromProps(e){return{circleRadius:r.getRadiusFromProps(e),maxBarSize:r.getMaxBarSize(e)}}componentDidUpdate(e,t){this.analyser.fftSize=this.props.fftSize,this.processSound(this.props.soundStream)}componentWillUnmount(){this.analyser&&this.analyser.numberOfInputs>0&&this.analyser.disconnect(),this.audioCtx&&this.audioCtx.close(),this.analyser=null,this.audioCtx=null}static distributeAngles(e,t){return e/t*2*Math.PI+Math.PI/3}static getRadiusFromProps(e){return Math.min(e.width,e.height)*e.ratio/2}static getMaxBarSize(e){return Math.min(e.width,e.height)*(1-e.ratio)/2}processSound(e){const t=this.props,i=t.width,a=t.height,n=this.state.circleRadius,s=this.analyser.frequencyBinCount;this.particles=Array(s).fill({}).map((e,t)=>{const o=r.distributeAngles(t,s/2);return{x:i/2+Math.cos(o)*n,y:a/2+Math.sin(o)*n,angle:o}}),this.audioCtx.createMediaStreamSource(e).connect(this.analyser)}draw(){const e=this.props,t=e.width,i=e.height,a=e.lineWidth,n=this.state,s=n.maxBarSize,r=n.circleRadius;if(this.analyser&&this.analyser.numberOfInputs>0){this.analyser.getByteFrequencyData(this.spectrum);const e=this.analyser.frequencyBinCount,n=this.canvas.current.getContext("2d");n.clearRect(0,0,t,i),n.fillStyle="#ff7f27",n.strokeStyle="#ff7f27",n.lineWidth=a||1;let l,c,h,u=0;for(var o=0;o<e;o++){u+=this.spectrum[o]*this.spectrum[o],l=this.spectrum[o]/256*s;const e=this.particles[o];c=t/2+Math.cos(e.angle)*(l+r),h=i/2+Math.sin(e.angle)*(l+r),n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(c,h),n.stroke(),n.closePath()}u/=e,u=Math.sqrt(u),u/=256,this.drawLogo(n,u)}requestAnimationFrame(this.draw)}drawLogo(e,t){const i=this.props,a=i.width,n=i.height,s=this.state.circleRadius,r=a/2,o=n/2,l=s/3;[e=>{e.moveTo(r-s/3,o+s/2),e.lineTo(r+s/3,o+s/2)},e=>{e.moveTo(r,o+s/2),e.lineTo(r,o+s/3)},e=>{e.arc(r,o,s/3,0,Math.PI)},e=>{e.arc(r,o,l,0,Math.PI),e.moveTo(r+l,o-l),e.lineTo(r+l,o),e.arc(r,o-l,l,0,Math.PI,!0),e.moveTo(r-l,o-l),e.lineTo(r-l,o)}].forEach(t=>{e.beginPath(),t(e),e.stroke(),e.closePath()});const c=s,h=Math.floor(c*t);if(!(h<1))if(h<l){const t=(l-h)/l,i=Math.asin(t),a=Math.cos(i);e.beginPath(),e.arc(r,o,l,i,Math.PI-i),e.lineTo(r+a*l,o+t*l),e.closePath(),e.fill()}else if(h<2*l){const t=h-l;e.beginPath(),e.arc(r,o,l,0,Math.PI),e.lineTo(r-l,o-t),e.lineTo(r+l,o-t),e.lineTo(r+l,o),e.closePath(),e.fill()}else{const t=(l-(h-2*l))/l,i=Math.asin(t),a=Math.cos(i);e.beginPath(),e.arc(r,o,l,0,Math.PI),e.lineTo(r-l,o-l),e.arc(r,o-l,l,Math.PI,Math.PI+i),e.lineTo(r+a*l,o-l-t*l),e.arc(r,o-l,l,2*Math.PI-i,2*Math.PI),e.lineTo(r+l,o),e.closePath(),e.fill()}}render(){return n.a.createElement("canvas",{width:this.props.width,height:this.props.height,ref:this.canvas})}}var o=r,l=function(e,t,i,a){return new(i||(i=Promise))(function(n,s){function r(e){try{l(a.next(e))}catch(e){s(e)}}function o(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(r,o)}l((a=a.apply(e,t||[])).next())})};const c={audio:!0},h={display:"grid",justifyItems:"center",gridGap:"1rem",padding:"1rem"},u={backgroundColor:"white"};var d=class extends n.a.Component{constructor(e){super(e),this.state={devices:null,selectedMic:null,displayTestAudio:!1,audioStreamForceUpdate:1,width:400,height:400,ratio:.5,fftSize:8,lineWidth:1.2},this.createDevices=this.createDevices.bind(this),this.changeTestAudioSource=this.changeTestAudioSource.bind(this)}componentWillMount(){this.createDevices()}componentWillUnmount(){this.testStreamAudio&&this.testStreamAudio.getTracks().forEach(e=>e.stop())}createDevices(){return l(this,void 0,void 0,function*(){if(navigator.mediaDevices.enumerateDevices){let e=null;try{e=yield navigator.mediaDevices.getUserMedia(c);const t={audio:(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind)},i=e.getTracks().find(e=>"audio"===e.kind),a=t.audio.find(e=>e.label===i.label),n=a?a.deviceId:t.audio.length>0?t.audio[0].deviceId:null;this.setState({devices:t,selectedMic:n},()=>this.changeTestAudioSource())}catch(e){console.error(e)}finally{e&&e.getTracks().forEach(e=>e.stop())}}})}changeTestAudioSource(){return l(this,void 0,void 0,function*(){const{selectedMic:e}=this.state,t=yield navigator.mediaDevices.getUserMedia({video:!1,audio:{deviceId:e,sampleRate:{ideal:8e3}}});yield function(e){return new Promise(t=>{setTimeout(()=>t(),e)})}(500),this.testStreamAudio&&this.testStreamAudio.getTracks().forEach(e=>e.stop()),this.testStreamAudio=t,this.setState({displayTestAudio:!0})})}render(){const{devices:e,selectedMic:t,displayTestAudio:i,width:a,height:s,ratio:r,lineWidth:l}=this.state;return n.a.createElement("div",{style:h},n.a.createElement("label",null,"Microphone:",n.a.createElement("select",{value:t||"",onChange:e=>this.setState({selectedMic:e.target.value},()=>this.changeTestAudioSource())},e&&e.audio&&e.audio.map(e=>n.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label)))),n.a.createElement("label",null,"Width:",n.a.createElement("input",{type:"number",value:this.state.width,min:1,max:1e3,onChange:e=>this.setState({width:Number.parseInt(e.target.value)})})),n.a.createElement("label",null,"Height:",n.a.createElement("input",{type:"number",value:this.state.height,min:1,max:1e3,onChange:e=>this.setState({height:Number.parseInt(e.target.value)})})),n.a.createElement("label",null,"Ratio:",n.a.createElement("input",{type:"range",value:this.state.ratio,step:.01,min:0,max:1,onChange:e=>this.setState({ratio:Number.parseFloat(e.target.value)})})),n.a.createElement("label",null,"FFT Size:",n.a.createElement("input",{type:"range",value:this.state.fftSize,step:1,min:4,max:14,onChange:e=>this.setState({fftSize:Number.parseInt(e.target.value)})})),n.a.createElement("label",null,"Line Width:",n.a.createElement("input",{type:"range",value:this.state.lineWidth,step:.1,min:.1,max:10,onChange:e=>this.setState({lineWidth:Number.parseFloat(e.target.value)})})),n.a.createElement("div",{style:u},i&&n.a.createElement(o,{soundStream:this.testStreamAudio,fftSize:Math.pow(2,this.state.fftSize),forceUpdater:++this.state.audioStreamForceUpdate,width:a,height:s,ratio:r,lineWidth:l})))}};i.n(s).a.render(n.a.createElement("div",{style:{width:"100vw",height:"100vh"}},n.a.createElement(d,null)),document.getElementById("root"))}});